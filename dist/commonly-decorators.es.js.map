{"version":3,"file":"commonly-decorators.es.js","sources":["../src/lib/freeze.ts","../src/lib/miniprogram/Assemble.ts","../src/index.ts"],"sourcesContent":["import freezeClick from \"freeze-click\";\n\nexport default function freeze(maxTimeout = 10000) {\n  return function closureFn(\n    target: any,\n    property: string,\n    descriptor: PropertyDescriptor,\n  ) {\n    const fn = descriptor.value;\n\n    descriptor.value = freezeClick(async function newFn(\n      this: any,\n      fc,\n      ...opts\n    ) {\n      try {\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      } finally {\n        fc.cancel();\n      }\n    }, maxTimeout);\n  };\n}\n","interface IInject {\n  new (...opts: any[]): any;\n}\n\nexport function Assemble(\n  key: string,\n  constructor: IInject,\n  constructorArgs?: string[],\n) {\n  return function closureFn(target: any, property: string) {\n    const fn = target[key];\n\n    if (typeof fn !== \"function\" && typeof fn?.then !== \"function\") {\n      target[key] = async function newFn(...opts: any[]) {\n        try {\n          const args =\n            (opts[0] ? constructorArgs?.map((item) => opts[0][item]) : []) ||\n            [];\n          this[property] = new constructor(...args);\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      return;\n    }\n\n    target[key] = async function newFn(...opts: any[]) {\n      try {\n        const args =\n          (opts[0] ? constructorArgs?.map((item) => opts[0][item]) : []) || [];\n        this[property] = new constructor(...args);\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      }\n    };\n  };\n}\n\nexport function AssembleValue<IValue = unknown>(key: string, value: IValue) {\n  return function closureFn(target: any, property: string) {\n    const fn = target[key];\n\n    if (typeof fn !== \"function\" && typeof fn?.then !== \"function\") {\n      target[key] = async function newFn() {\n        try {\n          this[property] = value;\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      return;\n    }\n\n    target[key] = async function newFn(...opts: any[]) {\n      try {\n        this[property] = value;\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      }\n    };\n  };\n}\n","import freeze from \"./lib/freeze\";\nimport * as miniprogram from \"./lib/miniprogram\";\nexport * from \"./lib/miniprogram\";\n\nexport { freeze };\n\nexport default {\n  freeze,\n  miniprogram,\n};\n"],"names":[],"mappings":"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"}