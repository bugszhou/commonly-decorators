{"version":3,"file":"commonly-decorators.min.js","sources":["../src/lib/freeze.ts","../src/lib/miniprogram/Assemble.ts","../src/index.ts"],"sourcesContent":["import freezeClick from \"freeze-click\";\n\nexport default function freeze(maxTimeout = 10000) {\n  return function closureFn(\n    target: any,\n    property: string,\n    descriptor: PropertyDescriptor,\n  ) {\n    const fn = descriptor.value;\n\n    descriptor.value = freezeClick(async function newFn(\n      this: any,\n      fc,\n      ...opts\n    ) {\n      try {\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      } finally {\n        fc.cancel();\n      }\n    }, maxTimeout);\n  };\n}\n","interface IInject {\n  new (...opts: any[]): any;\n}\n\nexport function Assemble(\n  key: string,\n  constructor: IInject,\n  constructorArgs?: string[],\n) {\n  return function closureFn(target: any, property: string) {\n    const fn = target[key];\n\n    if (typeof fn !== \"function\" && typeof fn?.then !== \"function\") {\n      target[key] = async function newFn(...opts: any[]) {\n        try {\n          const args =\n            (opts[0] ? constructorArgs?.map((item) => opts[0][item]) : []) ||\n            [];\n          this[property] = new constructor(...args);\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      return;\n    }\n\n    target[key] = async function newFn(...opts: any[]) {\n      try {\n        const args =\n          (opts[0] ? constructorArgs?.map((item) => opts[0][item]) : []) || [];\n        this[property] = new constructor(...args);\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      }\n    };\n  };\n}\n\nexport function AssembleValue<IValue = unknown>(key: string, value: IValue) {\n  return function closureFn(target: any, property: string) {\n    const fn = target[key];\n\n    if (typeof fn !== \"function\" && typeof fn?.then !== \"function\") {\n      target[key] = async function newFn() {\n        try {\n          this[property] = value;\n        } catch (e) {\n          console.error(e);\n        }\n      };\n      return;\n    }\n\n    target[key] = async function newFn(...opts: any[]) {\n      try {\n        this[property] = value;\n        const result = await fn.apply(this, opts);\n        return result;\n      } catch (e) {\n        throw e;\n      }\n    };\n  };\n}\n","import freeze from \"./lib/freeze\";\nimport * as miniprogram from \"./lib/miniprogram\";\nexport * from \"./lib/miniprogram\";\n\nexport { freeze };\n\nexport default {\n  freeze,\n  miniprogram,\n};\n"],"names":["freeze","maxTimeout","target","property","descriptor","fn","value","freezeClick","fc","opts","_i","arguments","length","apply","this","_a","sent","cancel","Assemble","key","constructor","constructorArgs","then","args","map","item","__spreadArray","e","console","error","AssembleValue","index","miniprogram","Object","__proto__","exports","defineProperty"],"mappings":"g5DAEwB,SAAAA,EAAOC,GAC7B,YAD6B,IAAAA,IAAAA,EAAkB,KACxC,SACLC,EACAC,EACAC,GAEA,IAAMC,EAAKD,EAAWE,MAEtBF,EAAWE,MAAQC,EAAAA,SAAY,SAE7BC,OACA,IAAOC,EAAA,GAAAC,EAAA,EAAPA,EAAOC,UAAAC,OAAPF,IAAAD,EAAOC,EAAA,GAAAC,UAAAD,6FAGU,8BAAM,CAAA,EAAAL,EAAGQ,MAAMC,KAAML,WACpC,MAAA,CAAA,EADeM,EAA0BC,eAGzC,6BAEAR,EAAGS,uCAEJhB,aCnBSiB,EACdC,EACAC,EACAC,GAEA,OAAO,SAAmBnB,EAAaC,GACrC,IAAME,EAAKH,EAAOiB,GAEA,mBAAPd,GAAyC,mBAAbA,eAAAA,EAAIiB,MAc3CpB,EAAOiB,GAAO,eAAqB,IAAcV,EAAA,GAAAC,EAAA,EAAdA,EAAcC,UAAAC,OAAdF,IAAAD,EAAcC,GAAAC,UAAAD,mGAK9B,6BAHTa,GACHd,EAAK,GAAKY,aAAe,EAAfA,EAAiBG,KAAI,SAACC,GAAS,OAAAhB,EAAK,GAAGgB,MAAS,KAAO,GACpEX,KAAKX,GAAgB,IAAAiB,aAAAA,EAAWM,EAAA,MAAA,GAAIH,GAAI,KACnB,CAAA,EAAAlB,EAAGQ,MAAMC,KAAML,WACpC,MAAA,CAAA,EADeM,EAA0BC,eAGzC,wCArBFd,EAAOiB,GAAO,eAAqB,IAAcV,EAAA,GAAAC,EAAA,EAAdA,EAAcC,UAAAC,OAAdF,IAAAD,EAAcC,GAAAC,UAAAD,4EAC/C,IACQa,GACHd,EAAK,GAAKY,aAAA,EAAAA,EAAiBG,KAAI,SAACC,GAAS,OAAAhB,EAAK,GAAGgB,MAAS,KAC3D,GACFX,KAAKX,GAAgB,IAAAiB,aAAAA,EAAWM,EAAA,MAAA,GAAIH,GAAI,KACxC,MAAOI,GACPC,QAAQC,MAAMF,qBAoBR,SAAAG,EAAgCX,EAAab,GAC3D,OAAO,SAAmBJ,EAAaC,GACrC,IAAME,EAAKH,EAAOiB,GAEA,mBAAPd,GAAyC,mBAAbA,eAAAA,EAAIiB,MAW3CpB,EAAOiB,GAAO,eAAqB,IAAcV,EAAA,GAAAC,EAAA,EAAdA,EAAcC,UAAAC,OAAdF,IAAAD,EAAcC,GAAAC,UAAAD,6FAG9B,6BADfI,KAAKX,GAAYG,EACI,CAAA,EAAAD,EAAGQ,MAAMC,KAAML,WACpC,MAAA,CAAA,EADeM,EAA0BC,eAGzC,wCAhBFd,EAAOiB,GAAO,8EACZ,IACEL,KAAKX,GAAYG,EACjB,MAAOqB,GACPC,QAAQC,MAAMF,qBAgBxB,IC3DeI,EAAA,CACb/B,OAAMA,EACNgC,YDyDFC,OAAAjC,OAAA,CAAAkC,UAAA,KAAAhB,SAAAA,EAAAY,cAAAA,KCxDCK,EAAAjB,SAAAA,EAAAiB,EAAAL,cAAAA,EAAAK,EAAA,QAAAJ,EAAAI,EAAAnC,OAAAA,EAAAiC,OAAAG,eAAAD,EAAA,aAAA,CAAA7B,OAAA"}